<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Description of methods for estimating Gini indexes, variance estimates and confidence intervals using GiniVarInterval</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Description of methods for estimating Gini
indexes, variance estimates and confidence intervals using
<strong>GiniVarInterval</strong></h1>


<div id="TOC">
<ul>
<li><a href="#infinite-populations" id="toc-infinite-populations"><span class="toc-section-number">1</span> Infinite populations</a>
<ul>
<li><a href="#estimators-of-the-gini-index" id="toc-estimators-of-the-gini-index"><span class="toc-section-number">1.1</span> Estimators of the Gini
index</a></li>
<li><a href="#variance-estimation-and-confidence-intervals" id="toc-variance-estimation-and-confidence-intervals"><span class="toc-section-number">1.2</span> Variance estimation and confidence
intervals</a>
<ul>
<li><a href="#bootstrap" id="toc-bootstrap"><span class="toc-section-number">1.2.1</span> Bootstrap</a></li>
<li><a href="#jackknife" id="toc-jackknife"><span class="toc-section-number">1.2.2</span> Jackknife</a></li>
<li><a href="#linearization" id="toc-linearization"><span class="toc-section-number">1.2.3</span> Linearization</a></li>
<li><a href="#empirical-likelihood" id="toc-empirical-likelihood"><span class="toc-section-number">1.2.4</span> Empirical likelihood</a></li>
</ul></li>
</ul></li>
<li><a href="#finite-populations" id="toc-finite-populations"><span class="toc-section-number">2</span> Finite populations</a>
<ul>
<li><a href="#estimators-of-the-gini-index-1" id="toc-estimators-of-the-gini-index-1"><span class="toc-section-number">2.1</span> Estimators of the Gini
index</a></li>
<li><a href="#variance-estimation-and-confidence-intervals-1" id="toc-variance-estimation-and-confidence-intervals-1"><span class="toc-section-number">2.2</span> Variance estimation and confidence
intervals</a>
<ul>
<li><a href="#bootstrap-1" id="toc-bootstrap-1"><span class="toc-section-number">2.2.1</span> Bootstrap</a></li>
<li><a href="#jackknife-1" id="toc-jackknife-1"><span class="toc-section-number">2.2.2</span> Jackknife</a></li>
<li><a href="#linearization-1" id="toc-linearization-1"><span class="toc-section-number">2.2.3</span> Linearization</a></li>
</ul></li>
</ul></li>
<li><a href="#references" id="toc-references"><span class="toc-section-number">3</span> References</a></li>
</ul>
</div>

<p>The aim of this vignette is to describe the various methods for
estimating the Gini index, for both infinite and finite populations, as
well as the methods for estimating its variance, as implemented in the
<strong>giniVarCI</strong> package. Different confidence intervals for
the Gini index are also explained.</p>
<p>To exemplify the use of the different functions, we assume that
inequality is measured for a nonnegative and continuous random variable
<span class="math inline">\(Y\)</span>. A popular formulation of the
Gini index (<span class="math inline">\(G\)</span>) is defined by (see
David, 1968; Kendall and Stuart, 1977; Qin et al., 2010): <span class="math display">\[
G = \frac{1}{2 \mu_{Y}} \int_{0}^{+\infty} \int_{0}^{+\infty}
|x-y|dF_{Y}(x)dF_{Y}(y),
\]</span> where <span class="math display">\[\mu_{Y}=E[Y]=\int_{0}^{+\infty}yf(y)dy=\int_{0}^{+\infty}ydF_{Y}(y),\]</span>
is the mean of <span class="math inline">\(Y\)</span>, and <span class="math inline">\(F_{Y}(y)=P(Y\leq y)\)</span> and <span class="math inline">\(f(y)\)</span> are the cumulative distribution
function and the probability density function of <span class="math inline">\(Y\)</span>, respectively.</p>
<p>In practice, the value of <span class="math inline">\(G\)</span> is
estimated by means of a sample <span class="math inline">\(S\)</span>
with size <span class="math inline">\(n\)</span>, which can be selected
from either infinite or finite populations (Berger and Gedik Balay,
2020; Muñoz et al., 2023).</p>
<div id="infinite-populations" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Infinite
populations</h1>
<div id="estimators-of-the-gini-index" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Estimators of the
Gini index</h2>
<p>For infinite populations, <span class="math inline">\(\{Y_{i}: i\in
S\}\)</span> denotes a sequence, with size <span class="math inline">\(n\)</span>, of nonnegative random variables with
the same distribution as the variable of interest <span class="math inline">\(Y\)</span>. The Gini index (<span class="math inline">\(G\)</span>) is estimated using the observation of
individuals selected in the sample, which are denoted as <span class="math inline">\(\{y_{i}: i\in S\}\)</span>. A popular estimator of
the Gini index is (see Langel and Tille, 2013; Giorgi and Gigliarano,
2017; Muñoz et al., 2023): <span class="math display">\[\widehat{G} =
\displaystyle \frac{2}{\overline{y}n^2}\sum_{i \in S}iy_{(i)} -
\frac{n+1}{n}, \]</span> where <span class="math inline">\(\overline{y}=n^{-1}\sum_{i=1}^{n}y_i\)</span>, and
<span class="math inline">\(y_{(i)}\)</span> are the ordered values (in
non-decreasing order) of the sample observations <span class="math inline">\(y_i\)</span>. This is the expression computed by
the functions <em>iginindex()</em> (<code>method = 5</code>) and
<em>igini()</em> when <code>bias.correction = FALSE</code>.</p>
<p>The estimator <span class="math inline">\(\widehat{G}\)</span> can be
biased for small sample sizes (Deltas, 2003). The bias corrected
(<em>bc</em>) version of <span class="math inline">\(\widehat{G}\)</span> is: <span class="math display">\[\widehat{G}^{bc} = \displaystyle
\frac{2}{\overline{y}n(n-1)}\sum_{i \in S}iy_{(i)} -
\frac{n+1}{n-1},\]</span> which corresponds to the Gini index bias
correction version computed by <em>iginindex()</em>
(<code>method = 5</code>) and <em>igini()</em> when
<code>bias.correction = TRUE</code>.</p>
<p>In the first example, a sample with size <code>n=100</code> is
generated using the <em>gsample()</em> function from the standard
logNormal distribution (<code>distribution = &quot;lognormal&quot;</code>) with
true Gini index is <span class="math inline">\(G=0.5\)</span>
(<code>gini = 0.5</code>) and the Gini index is estimated using bias
correction.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(giniVarCI)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">gsample</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">gini =</span> <span class="fl">0.5</span>, <span class="at">distribution =</span> <span class="st">&quot;lognormal&quot;</span>)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">igini</span>(y)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co">#&gt; [1] 0.4671929</span></span></code></pre></div>
<p><em>iginindex()</em> can be used to estimate the Gini index using
various estimation methods and both <strong>R</strong> and
<strong>C++</strong> codes. See <code>help(iginindex)</code> for a
detailed description of the various estimation methods. Efficiency
comparisons between both implementations and with other functions
available in other packages, such as <strong>laeken</strong>,
<strong>DescTools</strong>, <strong>ineq</strong> or
<strong>REAT</strong>, can be made using, for instance, the function
<em>microbenchmark()</em>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#Comparing the computation time for the various estimation methods using R </span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>microbenchmark<span class="sc">::</span><span class="fu">microbenchmark</span>(</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="fu">iginindex</span>(y, <span class="at">method =</span> <span class="dv">1</span>,  <span class="at">useRcpp =</span> <span class="cn">FALSE</span>),</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="fu">iginindex</span>(y, <span class="at">method =</span> <span class="dv">2</span>,  <span class="at">useRcpp =</span> <span class="cn">FALSE</span>),</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="fu">iginindex</span>(y, <span class="at">method =</span> <span class="dv">3</span>,  <span class="at">useRcpp =</span> <span class="cn">FALSE</span>),</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="fu">iginindex</span>(y, <span class="at">method =</span> <span class="dv">4</span>,  <span class="at">useRcpp =</span> <span class="cn">FALSE</span>),</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="fu">iginindex</span>(y, <span class="at">method =</span> <span class="dv">5</span>,  <span class="at">useRcpp =</span> <span class="cn">FALSE</span>),</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="fu">iginindex</span>(y, <span class="at">method =</span> <span class="dv">6</span>,  <span class="at">useRcpp =</span> <span class="cn">FALSE</span>),</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="fu">iginindex</span>(y, <span class="at">method =</span> <span class="dv">7</span>,  <span class="at">useRcpp =</span> <span class="cn">FALSE</span>),</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="fu">iginindex</span>(y, <span class="at">method =</span> <span class="dv">8</span>,  <span class="at">useRcpp =</span> <span class="cn">FALSE</span>),</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="fu">iginindex</span>(y, <span class="at">method =</span> <span class="dv">9</span>,  <span class="at">useRcpp =</span> <span class="cn">FALSE</span>),</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="fu">iginindex</span>(y, <span class="at">method =</span> <span class="dv">10</span>, <span class="at">useRcpp =</span> <span class="cn">FALSE</span>) </span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>)</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co">#&gt; Unit: microseconds</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co">#&gt;                                        expr    min       lq      mean   median</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co">#&gt;   iginindex(y, method = 1, useRcpp = FALSE)  144.1   164.10   256.703   185.15</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co">#&gt;   iginindex(y, method = 2, useRcpp = FALSE)   13.9    20.30    33.951    25.50</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co">#&gt;   iginindex(y, method = 3, useRcpp = FALSE)   11.5    17.10    29.406    21.55</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="co">#&gt;   iginindex(y, method = 4, useRcpp = FALSE)   15.5    22.85    36.819    28.70</span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="co">#&gt;   iginindex(y, method = 5, useRcpp = FALSE)   16.2    21.80    41.324    27.45</span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="co">#&gt;   iginindex(y, method = 6, useRcpp = FALSE)   31.3    63.60    95.618    80.15</span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a><span class="co">#&gt;   iginindex(y, method = 7, useRcpp = FALSE)  948.3  1024.75  1356.977  1149.25</span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="co">#&gt;   iginindex(y, method = 8, useRcpp = FALSE)  779.4   897.05  1148.337   975.20</span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="co">#&gt;   iginindex(y, method = 9, useRcpp = FALSE)  751.7   832.75  1073.753   916.95</span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a><span class="co">#&gt;  iginindex(y, method = 10, useRcpp = FALSE) 9899.3 12344.85 14473.612 14318.45</span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a><span class="co">#&gt;        uq     max neval</span></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a><span class="co">#&gt;    239.50  3925.8   100</span></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a><span class="co">#&gt;     39.05   154.9   100</span></span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a><span class="co">#&gt;     31.75   215.0   100</span></span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a><span class="co">#&gt;     43.95   170.7   100</span></span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a><span class="co">#&gt;     41.70   544.4   100</span></span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a><span class="co">#&gt;    102.00   602.7   100</span></span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a><span class="co">#&gt;   1499.85  4320.1   100</span></span>
<span id="cb2-36"><a href="#cb2-36" tabindex="-1"></a><span class="co">#&gt;   1254.35  4180.3   100</span></span>
<span id="cb2-37"><a href="#cb2-37" tabindex="-1"></a><span class="co">#&gt;   1275.00  3225.7   100</span></span>
<span id="cb2-38"><a href="#cb2-38" tabindex="-1"></a><span class="co">#&gt;  15689.05 24814.1   100</span></span>
<span id="cb2-39"><a href="#cb2-39" tabindex="-1"></a></span>
<span id="cb2-40"><a href="#cb2-40" tabindex="-1"></a></span>
<span id="cb2-41"><a href="#cb2-41" tabindex="-1"></a><span class="co"># Comparing the computation time for the various estimation methods using Rcpp</span></span>
<span id="cb2-42"><a href="#cb2-42" tabindex="-1"></a>microbenchmark<span class="sc">::</span><span class="fu">microbenchmark</span>(</span>
<span id="cb2-43"><a href="#cb2-43" tabindex="-1"></a><span class="fu">iginindex</span>(y, <span class="at">method =</span> <span class="dv">1</span>),</span>
<span id="cb2-44"><a href="#cb2-44" tabindex="-1"></a><span class="fu">iginindex</span>(y, <span class="at">method =</span> <span class="dv">2</span>),</span>
<span id="cb2-45"><a href="#cb2-45" tabindex="-1"></a><span class="fu">iginindex</span>(y, <span class="at">method =</span> <span class="dv">3</span>),</span>
<span id="cb2-46"><a href="#cb2-46" tabindex="-1"></a><span class="fu">iginindex</span>(y, <span class="at">method =</span> <span class="dv">4</span>),</span>
<span id="cb2-47"><a href="#cb2-47" tabindex="-1"></a><span class="fu">iginindex</span>(y, <span class="at">method =</span> <span class="dv">5</span>),</span>
<span id="cb2-48"><a href="#cb2-48" tabindex="-1"></a><span class="fu">iginindex</span>(y, <span class="at">method =</span> <span class="dv">6</span>),</span>
<span id="cb2-49"><a href="#cb2-49" tabindex="-1"></a><span class="fu">iginindex</span>(y, <span class="at">method =</span> <span class="dv">7</span>),</span>
<span id="cb2-50"><a href="#cb2-50" tabindex="-1"></a><span class="fu">iginindex</span>(y, <span class="at">method =</span> <span class="dv">8</span>),</span>
<span id="cb2-51"><a href="#cb2-51" tabindex="-1"></a><span class="fu">iginindex</span>(y, <span class="at">method =</span> <span class="dv">9</span>),</span>
<span id="cb2-52"><a href="#cb2-52" tabindex="-1"></a><span class="fu">iginindex</span>(y, <span class="at">method =</span> <span class="dv">10</span>) )</span>
<span id="cb2-53"><a href="#cb2-53" tabindex="-1"></a><span class="co">#&gt; Unit: microseconds</span></span>
<span id="cb2-54"><a href="#cb2-54" tabindex="-1"></a><span class="co">#&gt;                       expr     min       lq      mean   median       uq     max</span></span>
<span id="cb2-55"><a href="#cb2-55" tabindex="-1"></a><span class="co">#&gt;   iginindex(y, method = 1)    21.2    27.00    58.562    36.20    49.85  1068.6</span></span>
<span id="cb2-56"><a href="#cb2-56" tabindex="-1"></a><span class="co">#&gt;   iginindex(y, method = 2)    10.0    15.50    53.593    20.90    26.50  2465.1</span></span>
<span id="cb2-57"><a href="#cb2-57" tabindex="-1"></a><span class="co">#&gt;   iginindex(y, method = 3)     9.9    17.35    33.202    23.95    32.75   287.1</span></span>
<span id="cb2-58"><a href="#cb2-58" tabindex="-1"></a><span class="co">#&gt;   iginindex(y, method = 4)    10.2    18.15    41.034    24.20    30.70  1275.7</span></span>
<span id="cb2-59"><a href="#cb2-59" tabindex="-1"></a><span class="co">#&gt;   iginindex(y, method = 5)     9.0    12.95    22.263    20.50    25.35   146.6</span></span>
<span id="cb2-60"><a href="#cb2-60" tabindex="-1"></a><span class="co">#&gt;   iginindex(y, method = 6)     8.4    13.85    23.954    19.65    24.90   126.1</span></span>
<span id="cb2-61"><a href="#cb2-61" tabindex="-1"></a><span class="co">#&gt;   iginindex(y, method = 7)    31.0    46.85    70.911    58.30    67.65   442.9</span></span>
<span id="cb2-62"><a href="#cb2-62" tabindex="-1"></a><span class="co">#&gt;   iginindex(y, method = 8)    20.5    27.75    47.885    36.80    44.65   480.6</span></span>
<span id="cb2-63"><a href="#cb2-63" tabindex="-1"></a><span class="co">#&gt;   iginindex(y, method = 9)    19.0    29.75    66.249    40.65    55.00   940.7</span></span>
<span id="cb2-64"><a href="#cb2-64" tabindex="-1"></a><span class="co">#&gt;  iginindex(y, method = 10) 10681.2 16687.45 25121.255 22552.65 30578.30 87119.2</span></span>
<span id="cb2-65"><a href="#cb2-65" tabindex="-1"></a><span class="co">#&gt;  neval</span></span>
<span id="cb2-66"><a href="#cb2-66" tabindex="-1"></a><span class="co">#&gt;    100</span></span>
<span id="cb2-67"><a href="#cb2-67" tabindex="-1"></a><span class="co">#&gt;    100</span></span>
<span id="cb2-68"><a href="#cb2-68" tabindex="-1"></a><span class="co">#&gt;    100</span></span>
<span id="cb2-69"><a href="#cb2-69" tabindex="-1"></a><span class="co">#&gt;    100</span></span>
<span id="cb2-70"><a href="#cb2-70" tabindex="-1"></a><span class="co">#&gt;    100</span></span>
<span id="cb2-71"><a href="#cb2-71" tabindex="-1"></a><span class="co">#&gt;    100</span></span>
<span id="cb2-72"><a href="#cb2-72" tabindex="-1"></a><span class="co">#&gt;    100</span></span>
<span id="cb2-73"><a href="#cb2-73" tabindex="-1"></a><span class="co">#&gt;    100</span></span>
<span id="cb2-74"><a href="#cb2-74" tabindex="-1"></a><span class="co">#&gt;    100</span></span>
<span id="cb2-75"><a href="#cb2-75" tabindex="-1"></a><span class="co">#&gt;    100</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co"># Comparing the computation time for estimates of the Gini index in various R packages.</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>microbenchmark<span class="sc">::</span><span class="fu">microbenchmark</span>(</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="fu">igini</span>(y),</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>laeken<span class="sc">::</span><span class="fu">gini</span>(y),</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">Gini</span>(y),</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>ineq<span class="sc">::</span><span class="fu">Gini</span>(y),</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>REAT<span class="sc">::</span><span class="fu">gini</span>(y))</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt; Registered S3 methods overwritten by &#39;DescTools&#39;:</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt;   method   from</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#&gt;   lines.Lc ineq</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="co">#&gt;   plot.Lc  ineq</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="co">#&gt; Unit: microseconds</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="co">#&gt;                expr   min     lq      mean median     uq       max neval</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="co">#&gt;            igini(y)   9.8  12.00    34.814  14.35  18.05    1864.2   100</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="co">#&gt;     laeken::gini(y)  35.3  38.00   392.260  41.20  50.95   32288.5   100</span></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="co">#&gt;  DescTools::Gini(y)  56.6  61.80 11304.144  67.20  78.40 1122424.1   100</span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a><span class="co">#&gt;       ineq::Gini(y)  45.7  49.45   133.872  52.60  65.90    6572.8   100</span></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a><span class="co">#&gt;       REAT::gini(y) 100.7 108.30   234.544 113.10 137.15    8623.5   100</span></span></code></pre></div>
</div>
<div id="variance-estimation-and-confidence-intervals" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Variance estimation
and confidence intervals</h2>
<p>Variance estimators and confidence intervals are described using
different methods for the estimator of the non-bias corrected version of
Gini index <span class="math inline">\(\widehat{G}\)</span>, since as
<span class="math display">\[\widehat{G}^{bc} =
\frac{n}{n-1}\widehat{G},\]</span> the variance estimators and
confidence intervals based on <span class="math inline">\(\widehat{G}^{bc}\)</span> can be straightforwardly
derived. In particular, <span class="math display">\[\widehat{V}(\widehat{G}^{bc})=\frac{n^2}{(n-1)^2}\widehat{V}(\widehat{G}).\]</span>
Let <span class="math inline">\([L,U]\)</span> the lower and upper
limits of a confidence interval for <span class="math inline">\(G\)</span> based on <span class="math inline">\(\widehat{G}\)</span>. The confidence interval
based on <span class="math inline">\(\widehat{G}^{bc}\)</span> can be
computed as: <span class="math display">\[ \left[ \frac{n}{n-1}L,
\frac{n}{n-1}U\right].\]</span></p>
<div id="bootstrap" class="section level3" number="1.2.1">
<h3><span class="header-section-number">1.2.1</span> Bootstrap</h3>
<p>The argument <code>interval = pbootstrap</code> in the function
<em>igini()</em> returns the confidence interval for the Gini index
using the percentile bootstrap method. Let <span class="math inline">\(\{y_{1}^{*}(b),\ldots, y_{n}^{*}(b)\}\)</span> be
the <span class="math inline">\(b\)</span>th bootstrap sample taken from
the original sample <span class="math inline">\(\{y_{1},\ldots,
y_{n}\}\)</span> by simple random sampling with replacement, and <span class="math inline">\(\widehat{G}^{*}(b)\)</span> denotes the estimator
<span class="math inline">\(\widehat{G}\)</span> computed from the <span class="math inline">\(b\)</span>th bootstrap sample, with <span class="math inline">\(b=\{1,\ldots,B\}\)</span>, being <span class="math inline">\(B\)</span> the total number of bootstrap samples.
For a confidence level <span class="math inline">\(1-\alpha\)</span>,
the percentile bootstrap confidence interval is defined as (see Qin et
al., 2010): <span class="math display">\[\left[
\widehat{G}^{*}_{(\alpha/2)},
\widehat{G}^{*}_{(1-\alpha/2)}   \right],\]</span> where <span class="math inline">\(\widehat{G}^{*}_{(a)}\)</span> is the <span class="math inline">\(a\)</span>th quantile of the bootstrapped
coefficients <span class="math inline">\(\widehat{G}^{*}(b)\)</span>. A
variance estimator of the Gini index based on bootstrap is defined as
<span class="math display">\[\widehat{V}_{B}(\widehat{G})= \displaystyle
\frac{1}{B-1}\sum_{b=1}^{B}\left(\widehat{G}^{*}(b) - \overline{G}^{*}
\right)^2,\]</span> where <span class="math display">\[\overline{G}^{*}=\frac{1}{B}\sum_{b=1}^{B}\widehat{G}^{*}(b).\]</span></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co"># Gini index estimation and confidence interval using &#39;pbootstrap&#39;,</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="fu">igini</span>(y, <span class="at">interval =</span> <span class="st">&quot;pbootstrap&quot;</span>)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; $Gini</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; [1] 0.4671929</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; $Interval</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt;          lower     upper</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; [1,] 0.4004204 0.5135315</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt; $Variance</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; [1] 0.0008333577</span></span></code></pre></div>
<p><code>interval = &quot;BCa&quot;</code> computes the bias-corrected and
accelerated bootstrap interval (Davison and Hinkley, 1997). The idea of
this confidence interval is to correct for bias due to the skewness in
the distribution of bootstrap estimates. The <code>&quot;BCa&quot;</code>
confidence interval is defined as: <span class="math display">\[\left[
\widehat{G}^{*}_{(\alpha_{1})},
\widehat{G}^{*}_{(\alpha_{2})}   \right],\]</span> where <span class="math display">\[\alpha_{1}=\phi\left( \widehat{Z}_{0} +
\frac{\widehat{Z}_{0} + Z_{\alpha}}{1-\widehat{a} (\widehat{Z}_{0} +
\widehat{Z}_{\alpha}) } \right),\]</span></p>
<p><span class="math display">\[\alpha_{2}=\phi\left( \widehat{Z}_{0} +
\frac{\widehat{Z}_{0} + Z_{1-\alpha}}{1-\widehat{a} (\widehat{Z}_{0} +
\widehat{Z}_{1-\alpha}) } \right),\]</span> <span class="math inline">\(\phi(\cdot)\)</span> is the cumulative
distribution function of the standard Normal distribution, and <span class="math inline">\(Z_{a}\)</span> is the <span class="math inline">\(a\)</span>th quantile of the standard Normal
distribution. The bias-correction factor is defined as <span class="math display">\[\widehat{Z}_{0}=\phi^{-1}\left(\#\frac{\widehat{G}^{*}(b)
- \widehat{G}}{B}\right),\]</span> and the acceleration factor is given
by <span class="math display">\[\widehat{a}=\frac{\sum_{i \in
S}\left(\overline{G} -\widehat{G}_{-i}  \right)^3}{6\left\{\sum_{i \in
S}\left(\overline{G}
-\widehat{G}_{-i}  \right)^2\right\}^{3/2}},\]</span> where <span class="math inline">\(\widehat{G}_{-i}\)</span> are the jackknife
estimates defined in the following section, and <span class="math display">\[\overline{G} = \frac{1}{n}\sum_{i \in
S}\widehat{G}_{-i}.\]</span></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co"># Gini index estimation and confidence interval using &#39;Bca&#39;.</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="fu">igini</span>(y, <span class="at">interval =</span> <span class="st">&quot;BCa&quot;</span>)</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt; $Gini</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt; [1] 0.4671929</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt; $Interval</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt;          lower     upper</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt; [1,] 0.4178437 0.5280127</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt; $Variance</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt; [1] 0.0008051247</span></span></code></pre></div>
</div>
<div id="jackknife" class="section level3" number="1.2.2">
<h3><span class="header-section-number">1.2.2</span> Jackknife</h3>
<p>The <code>&quot;zjackknife&quot;</code> and <code>&quot;tjackknife&quot;</code> methods
compute the variance of the Gini index using the Ogwang Jackknife
procedure (Ogwang, 2000; Langel and Tille, 2013). This variance si given
by <span class="math display">\[\widehat{V}_{J}(\widehat{G})=
\displaystyle \frac{n-1}{n}\sum_{i \in S}\left(\widehat{G}_{-i}-
\overline{G} \right)^2,\]</span> where <span class="math display">\[\widehat{G}_{-i}=\widehat{G}+\frac{2}{\sum_{j \in
S}y_j - y_{(i)} }\left[ \frac{y_{(i)} \sum_{j \in S}jy_{(j)}}{n\sum_{j
\in S}y_j}+\frac{\sum_{j \in S}jy_{(j)}}{n(n-1)} - \frac{\sum_{j \in
S}y_j-\sum_{j=1}^{i}y_{(j)}  +iy_{(i)}
}{n-1}   \right]-\frac{1}{n(n-1)}, \]</span> with <span class="math inline">\(i=\{1,\ldots,n\}\)</span> being the jackknife
estimates, i.e., <span class="math inline">\(\widehat{G}_{-i}\)</span>
is the estimation of the Gini index when the unit <span class="math inline">\(i\)</span> is removed from the sample. For a
confidence level <span class="math inline">\(1-\alpha\)</span>, the
<code>&quot;zjackknife&quot;</code> confidence interval is defined as <span class="math display">\[\left[\widehat{G} -
Z_{1-\alpha/2}\sqrt{\widehat{V}_{J}(\widehat{G})},  \widehat{G} +
Z_{1-\alpha/2}\sqrt{\widehat{V}_{J}(\widehat{G})}   \right],\]</span>
where <span class="math inline">\(Z_{1-\alpha/2}\)</span> is the <span class="math inline">\((1-\alpha/2)\)</span>th quantile of the standard
Normal distribution.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co"># Gini index estimation and confidence interval using &#39;zjackknife&#39;.</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="fu">igini</span>(y, <span class="at">interval =</span> <span class="st">&quot;zjackknife&quot;</span>)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt; $Gini</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt; [1] 0.4671929</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt; $Interval</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt;          lower     upper</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#&gt; [1,] 0.4103563 0.5240296</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#&gt; $Variance</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co">#&gt; [1] 0.0008409313</span></span></code></pre></div>
<p><code>&quot;tjackknife&quot;</code> sustitutes the critical value <span class="math inline">\(Z_{1-\alpha/2}\)</span> by critical values
computed from the studentized bootstrap. This confidence interval is
given by<br />
<span class="math display">\[\left[\widehat{G} -
t_{J;1-\alpha/2}^{*}\sqrt{\widehat{V}_{J}(\widehat{G})},  \widehat{G} -
t_{J;\alpha/2}^{*}\sqrt{\widehat{V}_{J}(\widehat{G})}   \right],\]</span>
where <span class="math inline">\(t_{J;a}^{*}\)</span> is the <span class="math inline">\(a\)</span>th quantile of the values <span class="math display">\[ t^{*}_{J}(b)=\frac{\widehat{G}^{*}(b) -
\widehat{G}}{\sqrt{\widehat{V}_{J}\left[\widehat{G}^{*}(b)\right]}}\]</span>
computed using the bootstrap technique, where <span class="math inline">\(\widehat{V}_{J}\left[\widehat{G}^{*}(b)\right]\)</span>
is the estimated Ogwang Jackknife variance of <span class="math inline">\(\widehat{G}^{*}(b)\)</span> for the <span class="math inline">\(b\)</span>th bootstrap sample.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co"># Gini index estimation and confidence interval using &#39;tjackknife&#39;.</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="fu">igini</span>(y, <span class="at">interval =</span> <span class="st">&quot;tjackknife&quot;</span>)</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; $Gini</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; [1] 0.4671929</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt; $Interval</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt;          lower     upper</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt; [1,] 0.4108575 0.5349601</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt; $Variance</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#&gt; [1] 0.0008409313</span></span></code></pre></div>
</div>
<div id="linearization" class="section level3" number="1.2.3">
<h3><span class="header-section-number">1.2.3</span> Linearization</h3>
<p>The linearization technique for variance estimation (Deville, 1999)
has been applied to the following estimators of the Gini index: <span class="math display">\[\widehat{G}^{a} = \displaystyle
\frac{1}{2\overline{y}n^{2}}\sum_{i \in S}\sum_{j\in S}
|y_i-y_j|\]</span> and <span class="math display">\[\widehat{G}^{b}      = \displaystyle
\frac{2}{\overline{y}n}\sum_{i \in S}y_{i}\widehat{F}_{n}(y_{i}) -
1,\]</span> where <span class="math display">\[\widehat{F}_{n}(y_i)=\frac{1}{n}\sum_{j \in
S}\delta(y_j \leq y_i)\]</span> and <span class="math inline">\(\delta(\cdot)\)</span> is the indicator variable
that takes the value 1 when its argument is true and 0 otherwise. For a
given estimator <span class="math inline">\(\widehat{G}\)</span> and a
linearizated variable <span class="math inline">\(z\)</span>, the
confidence interval, with confidence level <span class="math inline">\(1-\alpha\)</span>, is defined as:<br />
<span class="math display">\[\left[\widehat{G} -
Z_{1-\alpha/2}\sqrt{\widehat{V}_{L}(\widehat{G})},  \widehat{G} +
Z_{1-\alpha/2}\sqrt{\widehat{V}_{L}(\widehat{G})}   \right],\]</span></p>
<p>where the variance estimator of the Gini index is given by: <span class="math display">\[\widehat{V}_{L}(\widehat{G})= \displaystyle
\frac{1}{n(n-1)}\sum_{i \in S}\left(z_{i} -
\overline{z}\right)^2,\]</span> and <span class="math display">\[\overline{z}=\frac{1}{n}\sum_{i \in
S}z_{i}.\]</span></p>
<p>On the one hand, <code>interval = &quot;zalinearization&quot;</code>
linearizates the estimator <span class="math inline">\(\widehat{G}^{a}\)</span>, and the corresponding
pseudo-values are (see Langel anf Tillé 2013):</p>
<p><span class="math display">\[z_{(i)}^{a}=\frac{1}{\overline{y}}\left[
\frac{2i}{n}\left( y_{(i)} - \widehat{\overline{Y}}_{(i)}\right) +
\overline{y} -  y_{(i)} -  \widehat{G}^{a}\left(\overline{y} +
y_{(i)}\right) \right],\]</span> where <span class="math display">\[\widehat{\overline{Y}}_{(i)} = \displaystyle
\frac{1}{i}\sum_{j = 1}^{i}y_{(j)}.\]</span></p>
<p>On the other hand, <code>interval = &quot;zblinearization&quot;</code>
linearizates the estimator <span class="math inline">\(\widehat{G}^{b}\)</span>, and the corresponding
pseudo values are (see Berger, 2008):</p>
<p><span class="math display">\[z_i^{b}=\frac{1}{\overline{y}}\left[
2y_i\widehat{F}_{n}(y_i) -
(\widehat{G}^{b}+1)(y_i+\overline{y})+2\frac{\sum_{j \in S}y_j\delta(y_j
\geq y_i)}{n}  \right].\]</span></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co"># Gini index estimation and confidence interval using &#39;zalinearization&#39;.</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="fu">igini</span>(y, <span class="at">interval =</span> <span class="st">&quot;zalinearization&quot;</span>)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; $Gini</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt; [1] 0.4671929</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; $Interval</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt;          lower     upper</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt; [1,] 0.4125876 0.5217982</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt; $Variance</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt; [1] 0.0007762</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co"># Gini index estimation and confidence interval using &#39;zblinearization&#39;.</span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="fu">igini</span>(y, <span class="at">interval =</span> <span class="st">&quot;zblinearization&quot;</span>)</span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="co">#&gt; $Gini</span></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="co">#&gt; [1] 0.4671929</span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a><span class="co">#&gt; $Interval</span></span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a><span class="co">#&gt;          lower     upper</span></span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a><span class="co">#&gt; [1,] 0.4107537 0.5236321</span></span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a><span class="co">#&gt; $Variance</span></span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a><span class="co">#&gt; [1] 0.0008292117</span></span></code></pre></div>
<p>Intervals <code>&quot;talinearization&quot;</code> and
<code>&quot;tblinearization&quot;</code> substitute the critical value <span class="math inline">\(Z_{1-\alpha/2}\)</span> by critical values
computed from the Studentized bootstrap. This confidence interval is
given by<br />
<span class="math display">\[\left[\widehat{G} -
t_{L;1-\alpha/2}^{*}\sqrt{\widehat{V}_{L}(\widehat{G})},  \widehat{G} -
t_{L;\alpha/2}^{*}\sqrt{\widehat{V}_{L}(\widehat{G})}   \right],\]</span>
where <span class="math inline">\(t_{L;a}^{*}\)</span> is the <span class="math inline">\(a\)</span>th quantile of the values <span class="math display">\[ t^{*}_{L}(b)=\frac{\widehat{G}^{*}(b) -
\widehat{G}}{\sqrt{\widehat{V}_{L}\left[\widehat{G}^{*}(b)\right]}}.\]</span>
<span class="math inline">\(\widehat{V}_{L}(\cdot)\)</span> is computed
using the pseudo-values <span class="math inline">\(z_{(i)}^{a}\)</span>
when <code>interval = &quot;zalinearization&quot;</code>, and using the
pseudo-values <span class="math inline">\(z_i^{b}\)</span> when
<code>interval = &quot;zblinearization&quot;</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co"># Gini index estimation and confidence interval using &#39;talinearization&#39;.</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="fu">igini</span>(y, <span class="at">interval =</span> <span class="st">&quot;talinearization&quot;</span>)</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; $Gini</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; [1] 0.4671929</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; $Interval</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt;          lower     upper</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt; [1,] 0.4195142 0.5253662</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt; $Variance</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#&gt; [1] 0.0007762</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co"># Gini index estimation and confidence interval using &#39;tblinearization&#39;.</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="fu">igini</span>(y, <span class="at">interval =</span> <span class="st">&quot;tblinearization&quot;</span>)</span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="co">#&gt; $Gini</span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="co">#&gt; [1] 0.4671929</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a><span class="co">#&gt; $Interval</span></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a><span class="co">#&gt;          lower     upper</span></span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a><span class="co">#&gt; [1,] 0.4224278 0.5329734</span></span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a><span class="co">#&gt; $Variance</span></span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a><span class="co">#&gt; [1] 0.0008292117</span></span></code></pre></div>
</div>
<div id="empirical-likelihood" class="section level3" number="1.2.4">
<h3><span class="header-section-number">1.2.4</span> Empirical
likelihood</h3>
<p>Intervals <code>&quot;ELchisq&quot;</code> and <code>&quot;ELboot&quot;</code> compute
the empirical likelihood (<span class="math inline">\(EL\)</span>)
method, a nonparametric technique that provides desirable inferences
under skewed distributions. The shape of the <span class="math inline">\(EL\)</span> confidence intervals are determined by
the data-driven likelihood ratio function (Owen, 2001).
<code>interval = &quot;ELchisq&quot;</code> obtains the <span class="math inline">\(EL\)</span> confidence interval, with confidence
level <span class="math inline">\(1-\alpha\)</span>, for the Gini index
as defined by Qin et al. (2010): <span class="math display">\[\left\{
\theta|-2R(\theta) \leq
\frac{\chi^2_{1;1-\alpha}}{k}\right\}\]</span></p>
<p>where <span class="math display">\[R(\theta)= - \sum_{i \in S}
log\{1+\lambda Z(y_i,\theta)\}\]</span> is the log-EL ratio statistic
for <span class="math inline">\(\theta = G\)</span>, <span class="math display">\[Z(y_i,\theta)=\{2\widehat{F}_{n}(y_i)-1\}y_{i} -
\theta y_i,\]</span> <span class="math inline">\(\lambda\)</span> is the
solution to <span class="math display">\[ \frac{1}{n}\sum_{i \in
S}\frac{Z(y_i,\theta)}{1+Z(y_i,\theta)}=0,\]</span> <span class="math inline">\(k=\widehat{\sigma}_{2}^{2}/\widehat{\sigma}_{1}^{2}\)</span>
is the scaling factor, <span class="math display">\[
\widehat{\sigma}_{j}^{2}=\frac{1}{n-1}\sum_{i \in S}\left(u_{ji} -
\overline{u}_{j} \right)^2,\]</span> with <span class="math inline">\(j=\{1,2\}\)</span>, <span class="math display">\[
\overline{u}_{j} = \frac{1}{n}\sum_{i \in S}u_{ji},\]</span> and <span class="math inline">\(\chi^2_{1;1-\alpha}\)</span> is the <span class="math inline">\((1-\alpha)\)</span>th quantile of Chi-Squared
distribution with one degree of freedom.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co"># Gini index estimation and confidence interval using &#39;ELchisq&#39;.</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="fu">igini</span>(y, <span class="at">interval =</span> <span class="st">&quot;ELchisq&quot;</span>)</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co">#&gt; $Gini</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co">#&gt; [1] 0.4671929</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co">#&gt; $Interval</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co">#&gt;          lower     upper</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="co">#&gt; [1,] 0.4216374 0.5319404</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="co">#&gt; $Variance</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="co">#&gt; [1] 0.0008292117</span></span></code></pre></div>
<p><code>interval = &quot;ELboot&quot;</code> substitutes the critical value based
on the Chi-Squared distribution by an empirical critical value based on
bootstrap. <code>&quot;ELboot&quot;</code> computes the <span class="math inline">\(EL\)</span> confidence interval (Qin et al.,
2010): <span class="math display">\[\left\{ \theta|-2R(\theta) \leq
C_{1-\alpha}\right\},\]</span> where <span class="math inline">\(C_{1-\alpha}\)</span> is the <span class="math inline">\((1-\alpha)\)</span>th quantile of the values <span class="math inline">\(\{-R_{1}^{*}(\widehat{G}),\ldots,
-R_{B}^{*}(\widehat{G})\}\)</span>, and where <span class="math inline">\(R_{b}^{*}(\widehat{G})\)</span> denotes the value
of <span class="math inline">\(R(\theta)\)</span> computed from the
<span class="math inline">\(b\)</span>th bootstrap sample.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co"># Gini index estimation and confidence interval using &#39;ELboot&#39;.</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="fu">igini</span>(y, <span class="at">interval =</span> <span class="st">&quot;ELboot&quot;</span>)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt; $Gini</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt; [1] 0.4671929</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; $Interval</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt;          lower     upper</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt; [1,] 0.4118394 0.5413343</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co">#&gt; $Variance</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">#&gt; [1] 0.0008343201</span></span></code></pre></div>
<p>The function <em>icompareCI()</em> compares the various confidence
intervals for the scenario of a sample derived from an infinite
population. The argument <code>plotCI = TRUE</code> plots the results
derived from the various available methods for constructing confidence
intervals.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co"># Comparisons of variance estimators and confidence intervals.</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="fu">icompareCI</span>(y, <span class="at">plotCI =</span> <span class="cn">FALSE</span>)</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co">#&gt;           interval    bc gini lowerlimit upperlimit var.gini</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co">#&gt; 1       zjackknife FALSE 0.46       0.41       0.52    8e-04</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt; 2       zjackknife  TRUE 0.47       0.41       0.52    8e-04</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt; 3       tjackknife FALSE 0.46       0.41       0.53    8e-04</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt; 4       tjackknife  TRUE 0.47       0.42       0.54    8e-04</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt; 5  zalinearization FALSE 0.46       0.41       0.52    8e-04</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt; 6  zalinearization  TRUE 0.47       0.41       0.52    8e-04</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt; 7  talinearization FALSE 0.46       0.41       0.52    8e-04</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co">#&gt; 8  talinearization  TRUE 0.47       0.42       0.52    8e-04</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co">#&gt; 9  zblinearization FALSE 0.46       0.41       0.52    8e-04</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co">#&gt; 10 zblinearization  TRUE 0.47       0.41       0.52    8e-04</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="co">#&gt; 11 tblinearization FALSE 0.46       0.42       0.53    8e-04</span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="co">#&gt; 12 tblinearization  TRUE 0.47       0.42       0.53    8e-04</span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="co">#&gt; 13      pbootstrap FALSE 0.46       0.40       0.51    8e-04</span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a><span class="co">#&gt; 14      pbootstrap  TRUE 0.47       0.40       0.51    8e-04</span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a><span class="co">#&gt; 15             BCa FALSE 0.46       0.42       0.53    7e-04</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a><span class="co">#&gt; 16             BCa  TRUE 0.47       0.42       0.53    8e-04</span></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a><span class="co">#&gt; 17         ELchisq FALSE 0.46       0.42       0.53    8e-04</span></span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a><span class="co">#&gt; 18         ELchisq  TRUE 0.47       0.42       0.53    8e-04</span></span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a><span class="co">#&gt; 19          ELboot FALSE 0.46       0.41       0.53    7e-04</span></span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a><span class="co">#&gt; 20          ELboot  TRUE 0.47       0.42       0.54    7e-04</span></span></code></pre></div>
</div>
</div>
</div>
<div id="finite-populations" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Finite populations</h1>
<div id="estimators-of-the-gini-index-1" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Estimators of the
Gini index</h2>
<p>For a finite population <span class="math inline">\(U\)</span>, <span class="math inline">\(\{Y_{i}: i\in U\}\)</span> denotes a sequence,
with size <span class="math inline">\(N\)</span>, of nonnegative random
variables with the same distribution as the variable of interest <span class="math inline">\(Y\)</span>, and <span class="math inline">\(\{y_{i}: i\in U\}\)</span> are the population
values of the variable of interest. A sample <span class="math inline">\(S\)</span> is selected from <span class="math inline">\(U\)</span> by using a sampling design with survey
weights <span class="math inline">\(w_i\)</span>, with <span class="math inline">\(i\in S\)</span>. For example, the survey weights
can be <span class="math inline">\(w_i = \pi_{i}^{-1}\)</span>, where
<span class="math inline">\(\pi_{i}=P(i\in S)\)</span> are the inclusion
probabilities (Muñoz et al., 2023). The Gini index (<span class="math inline">\(G\)</span>) is estimated using the observations of
individuals selected in the sample <span class="math inline">\(\{y_{i}:
i\in S\}\)</span>, and the corresponding survey weights <span class="math inline">\(\{w_{i}: i\in S\}\)</span>. The different methods
for estimating the Gini index are (see also Muñoz et al., 2023):</p>
<ul>
<li><code>method = 1</code> (Langel and Tillé, 2013).</li>
</ul>
<p><span class="math display">\[\widehat{G}_{w1}= \displaystyle
\frac{1}{2\widehat{N}^{2}\overline{y}_{w}}\sum_{i \in S}\sum_{j \in
S}w_{i}w_{j}|y_{i}-y_{j}|,\]</span> where <span class="math inline">\(\widehat{N}=\sum_{i \in S}w_i\)</span> and <span class="math display">\[\overline{y}_{w}= \frac{1}{\widehat{N}}\sum_{i
\in S}w_{i}y_{i}.\]</span></p>
<ul>
<li><code>method = 2</code> (Alfons and Templ, 2012; Langel and Tillé,
2013).</li>
</ul>
<p><span class="math display">\[\widehat{G}_{w2} =\displaystyle
\frac{2\sum_{i \in S}w_{(i)}^{+}\widehat{N}_{(i)}y_{(i)} -\sum_{i \in
S}w_{i}^{2}y_{i}  }{\widehat{N}^{2}\overline{y}_{w}}-1,\]</span> where
<span class="math inline">\(y_{(i)}\)</span> are the values <span class="math inline">\(y_i\)</span> sorted in increasing order, <span class="math inline">\(w_{(i)}^{+}\)</span> are the values <span class="math inline">\(w_i\)</span> sorted according to the increasing
order of the values <span class="math inline">\(y_i\)</span>, and <span class="math inline">\(\widehat{N}_{(i)}=\sum_{j=1}^{i}w_{(j)}^{+}\)</span>.
Note that Langel and Tillé (2013) show that <span class="math inline">\(\widehat{G}_{w1}=\widehat{G}_{w2}\)</span>.</p>
<ul>
<li><code>method = 3</code> (Berger, 2008).</li>
</ul>
<p><span class="math display">\[\widehat{G}_{w3} = \displaystyle
\frac{2}{\widehat{N}\overline{y}_{w}}\sum_{i \in
S}w_{i}y_{i}\widehat{F}_{w}^{\ast}(y_{i})-1, \]</span> where <span class="math display">\[\widehat{F}_{w}^{\ast}(t) = \displaystyle
\frac{1}{\widehat{N}}\sum_{i \in S}w_{i}[\delta(y_i &lt; t) +
0.5\delta(y_i = t)]\]</span> is the smooth (mid-point) distribution
function.</p>
<ul>
<li><code>method = 4</code> (Berger and Gedik-Balay, 2020).</li>
</ul>
<p><span class="math display">\[\widehat{G}_{w4} = 1 - \displaystyle
\frac{\overline{v}_{w}}{\overline{y}_{w}},\]</span> where <span class="math inline">\(\overline{v}_{w}=\widehat{N}^{-1}\sum_{i \in
S}w_{i}v_{i}\)</span> and <span class="math display">\[v_{i} =
\displaystyle \frac{1}{\widehat{N} - w_{i}}\sum_{ \substack{j \in S\\
j\neq i}}\min(y_{i},y_{j}).\]</span></p>
<ul>
<li><code>method = 5</code> (Lerman and Yitzhaki, 1989).</li>
</ul>
<p><span class="math display">\[\widehat{G}_{w5} = \displaystyle
\frac{2}{\widehat{N}\overline{y}_{w}} \sum_{i \in S} w_{(i)}^{+}[y_{(i)}
- \overline{y}_{w}]\left[ \widehat{F}_{w}^{LY}(y_{(i)}) -
\overline{F}_{w}^{LY} \right], \]</span> where <span class="math display">\[\widehat{F}_{w}^{LY}(y_{(i)}) = \displaystyle
\frac{1}{\widehat{N}}\left(\widehat{N}_{(i-1)} + \frac{w_{(i)}^{+}}{2}
\right)\]</span> and <span class="math display">\[\overline{F}_{w}^{LY}=\frac{1}{\widehat{N}}\sum_{i
\in S}w_{(i)}^{+}\widehat{F}_{w}^{LY}(y_{(i)}).\]</span></p>
<p>In the finite population example, income and weights from the 2006
Austrian EU-SILC data set (<strong>laeken</strong> package) are used to
estimate the Gini index in the Austrian region of Burgenland. The Gini
index is estimated using <em>fgini()</em> and <code>method = 2</code>
(the default method).</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">data</span>(eusilc, <span class="at">package=</span><span class="st">&quot;laeken&quot;</span>)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> eusilc<span class="sc">$</span>eqIncome[eusilc<span class="sc">$</span>db040 <span class="sc">==</span> <span class="st">&quot;Burgenland&quot;</span>]</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>w <span class="ot">&lt;-</span> eusilc<span class="sc">$</span>rb050[eusilc<span class="sc">$</span>db040 <span class="sc">==</span> <span class="st">&quot;Burgenland&quot;</span>]</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="fu">fgini</span>(y, w)</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co">#&gt; [1] 0.3205489</span></span></code></pre></div>
<p><em>fginindex()</em> can be used to estimate the Gini index using
various estimation methods and both <strong>R</strong> and
<strong>C++</strong> codes. Efficiency comparisons between both
implementations and with other functions available in other packages,
such as <strong>laeken</strong>, <strong>DescTools</strong>,
<strong>ineq</strong> or <strong>REAT</strong>, can be made using, for
example, the function <em>microbenchmark()</em>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co">#Comparing the computation time for the various estimation methods and using R</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>microbenchmark<span class="sc">::</span><span class="fu">microbenchmark</span>(</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="fu">fginindex</span>(y, w, <span class="at">method =</span> <span class="dv">1</span>,  <span class="at">useRcpp =</span> <span class="cn">FALSE</span>),</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="fu">fginindex</span>(y, w, <span class="at">method =</span> <span class="dv">2</span>,  <span class="at">useRcpp =</span> <span class="cn">FALSE</span>),</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="fu">fginindex</span>(y, w, <span class="at">method =</span> <span class="dv">3</span>,  <span class="at">useRcpp =</span> <span class="cn">FALSE</span>),</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="fu">fginindex</span>(y, w, <span class="at">method =</span> <span class="dv">4</span>,  <span class="at">useRcpp =</span> <span class="cn">FALSE</span>),</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="fu">fginindex</span>(y, w, <span class="at">method =</span> <span class="dv">5</span>,  <span class="at">useRcpp =</span> <span class="cn">FALSE</span>)</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>)</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co">#&gt; Unit: microseconds</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co">#&gt;                                          expr    min      lq      mean   median</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co">#&gt;  fginindex(y, w, method = 1, useRcpp = FALSE) 1315.7 1422.95  2091.698  1564.65</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="co">#&gt;  fginindex(y, w, method = 2, useRcpp = FALSE)   47.7   68.25   112.532   105.25</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="co">#&gt;  fginindex(y, w, method = 3, useRcpp = FALSE) 3665.1 4164.85  6859.617  5122.20</span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="co">#&gt;  fginindex(y, w, method = 4, useRcpp = FALSE) 7737.1 9392.00 12269.216 12195.65</span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="co">#&gt;  fginindex(y, w, method = 5, useRcpp = FALSE)   60.9  109.25   190.398   143.90</span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a><span class="co">#&gt;        uq     max neval</span></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="co">#&gt;   2003.60  7574.2   100</span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="co">#&gt;    133.25   282.4   100</span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="co">#&gt;   7488.70 31897.5   100</span></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a><span class="co">#&gt;  14806.60 21488.4   100</span></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="co">#&gt;    164.65  4365.5   100</span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a></span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a></span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a><span class="co"># Comparing the computation time for the various estimation methods and using Rcpp</span></span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a>microbenchmark<span class="sc">::</span><span class="fu">microbenchmark</span>(</span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a><span class="fu">fginindex</span>(y, w, <span class="at">method =</span> <span class="dv">1</span>),</span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a><span class="fu">fginindex</span>(y, w, <span class="at">method =</span> <span class="dv">2</span>),</span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a><span class="fu">fginindex</span>(y, w, <span class="at">method =</span> <span class="dv">3</span>),</span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a><span class="fu">fginindex</span>(y, w, <span class="at">method =</span> <span class="dv">4</span>),</span>
<span id="cb14-31"><a href="#cb14-31" tabindex="-1"></a><span class="fu">fginindex</span>(y, w, <span class="at">method =</span> <span class="dv">5</span>)</span>
<span id="cb14-32"><a href="#cb14-32" tabindex="-1"></a>)</span>
<span id="cb14-33"><a href="#cb14-33" tabindex="-1"></a><span class="co">#&gt; Unit: microseconds</span></span>
<span id="cb14-34"><a href="#cb14-34" tabindex="-1"></a><span class="co">#&gt;                         expr   min     lq    mean median    uq   max neval</span></span>
<span id="cb14-35"><a href="#cb14-35" tabindex="-1"></a><span class="co">#&gt;  fginindex(y, w, method = 1) 367.6 369.35 399.065 379.60 395.1 758.8   100</span></span>
<span id="cb14-36"><a href="#cb14-36" tabindex="-1"></a><span class="co">#&gt;  fginindex(y, w, method = 2)  42.2  53.60  77.953  58.60  83.9 278.8   100</span></span>
<span id="cb14-37"><a href="#cb14-37" tabindex="-1"></a><span class="co">#&gt;  fginindex(y, w, method = 3) 413.5 415.45 488.974 428.60 481.0 959.5   100</span></span>
<span id="cb14-38"><a href="#cb14-38" tabindex="-1"></a><span class="co">#&gt;  fginindex(y, w, method = 4) 349.7 352.15 377.131 362.05 368.6 549.9   100</span></span>
<span id="cb14-39"><a href="#cb14-39" tabindex="-1"></a><span class="co">#&gt;  fginindex(y, w, method = 5)  44.6  56.60  81.559  62.80  91.7 258.4   100</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="co"># Comparing the computation time for estimates of the Gini index in various R packages.</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co"># Comparing &#39;method = 2&#39;, used also by the laeken package. </span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>microbenchmark<span class="sc">::</span><span class="fu">microbenchmark</span>(</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="fu">fgini</span>(y,w),</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>laeken<span class="sc">::</span><span class="fu">gini</span>(y,w)</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>)</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co">#&gt; Unit: microseconds</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co">#&gt;                expr  min    lq   mean median    uq   max neval</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co">#&gt;         fgini(y, w) 28.6 32.25 40.654  35.45 41.55 132.4   100</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="co">#&gt;  laeken::gini(y, w) 46.4 54.70 64.262  59.00 65.75 241.4   100</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co"># Comparing &#39;method = 5&#39;, used also by the DescTools and REAT packages. </span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a>microbenchmark<span class="sc">::</span><span class="fu">microbenchmark</span>(</span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="fu">fgini</span>(y,w, <span class="at">method =</span> <span class="dv">5</span>),</span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">Gini</span>(y,w),</span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a>REAT<span class="sc">::</span><span class="fu">gini</span>(y, <span class="at">weighting =</span> w)</span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a>)</span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a><span class="co">#&gt; Unit: microseconds</span></span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a><span class="co">#&gt;                          expr   min     lq    mean median     uq   max neval</span></span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a><span class="co">#&gt;       fgini(y, w, method = 5)  31.3  37.95  53.580  43.45  57.15 204.1   100</span></span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a><span class="co">#&gt;         DescTools::Gini(y, w)  79.4  96.00 120.604 103.85 121.75 669.8   100</span></span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a><span class="co">#&gt;  REAT::gini(y, weighting = w) 184.5 242.55 296.965 261.90 308.05 817.2   100</span></span></code></pre></div>
</div>
<div id="variance-estimation-and-confidence-intervals-1" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Variance estimation
and confidence intervals</h2>
<p>Jackknife and linearization tecniques compute <em>pseudo-values</em>
(named as <span class="math inline">\(z_{i}\)</span>, with <span class="math inline">\(i \in S\)</span>) that require the use of an
expression for the variance estimation. The function <em>fgini()</em>
can compute the following type variance estimators using the argument
<code>varformula</code>:</p>
<ol style="list-style-type: decimal">
<li>The Horvitz-Thompson (<code>&quot;HT&quot;</code>) type variance estimator
(Hortvitz and Thompson, 1952).</li>
</ol>
<p><span class="math display">\[\widehat{V}_{HT}(\widehat{G}_{w}) =
\displaystyle \sum_{i\in S}\sum_{j\in
S}\breve{\Delta}_{ij}w_{i}w_{j}z_{i}z_{j},\]</span> which is computed
when <code>varformula = &quot;HT&quot;</code>, where <span class="math display">\[\breve{\Delta}_{ij}=\displaystyle
\frac{\pi_{ij}-\pi_{i}\pi_{j}}{\pi_{ij}}.\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li>The Sen-Yates-Grundy (<code>&quot;SYG&quot;</code>) type variance estimator
(Sen, 1953; Yates and Grundy, 1953).</li>
</ol>
<p><span class="math display">\[\widehat{V}_{SYG}(\widehat{G}_{w}) = -
\displaystyle \frac{1}{2}\sum_{i\in S}\sum_{j\in
S}\breve{\Delta}_{ij}(w_{i}z_i-w_{j}z_{j})^{2},\]</span> which is
computed when <code>varformula = &quot;SYG&quot;</code>.</p>
<ol start="3" style="list-style-type: decimal">
<li>The Hartley-Rao (<code>&quot;HR&quot;</code>) type variance estimator (Hartley
and Rao, 1962).</li>
</ol>
<p><span class="math display">\[\widehat{V}_{HR}(\widehat{G}_{w}) =
\displaystyle \frac{1}{n-1}\sum_{i\in S}\sum_{\substack{j \in S\\ j &lt;
i}}\left(1-\pi_i-\pi_j + \frac{1}{n}\sum_{k\in U}\pi_{k}^{2}
\right)(w_{i}z_i-w_{j}z_{j})^{2},\]</span> which is computed when
<code>varformula = &quot;HR&quot;</code>.</p>
<p>Note that the <code>&quot;HT&quot;</code> variance estimator may give negative
values, and the <code>&quot;SYG&quot;</code> variance estimator is suitable for
fixed-size sampling designs. This implies that <code>&quot;SYG&quot;</code> should
not be used under Poisson sampling. Fortunately, <code>&quot;HT&quot;</code>
always give positive values under this sampling design. We observe that
both Horvitz-Thompson and Sen-Yates-Grundy variance estimators depend on
second (joint) inclusion probabilities (argument <code>Pij</code>). The
Hàjek (1964) approximation <span class="math display">\[\pi_{ij}\cong
\pi_{i}\pi_{j}\left[1- \displaystyle
\frac{(1-\pi_{i})(1-\pi_{j})}{\sum_{i \in S}(1-\pi_{i})}
\right]\]</span> is used when the second (joint) inclusion probabilities
are not available (<code>Pij = NULL</code>). Note that the Hàjek
approximation is suggested for large-entropy sampling designs, large
samples, and large populations (see Tille 2006; Berger and Tille, 2009;
Haziza et al., 2008; Berger, 2011). For instance, this approximation is
not recomended for highly-stratified samples (Berger, 2005). The
Hartley-Rao variance estimator requires the first inclusion
probabilities at the population level (argument <code>PiU</code>).</p>
<div id="bootstrap-1" class="section level3" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Bootstrap</h3>
<p>For complex sampling designs, the rescaled bootstrap (Rao el al.,
1992; Rust and Rao, 1996) can be used for variance estimation and
construction of confidence intervals.
<code>interval = &quot;pbootstrap&quot;</code> returns the confidence interval for
the Gini index using the rescaled bootstrap with confidence limits
obtained by the percentile method. For a given estimator <span class="math inline">\(\widehat{G}_{w}\)</span> and a confidence level
<span class="math inline">\(1-\alpha\)</span>, this confidence interval
is given by <span class="math display">\[\left[
\widehat{G}^{*}_{w;\alpha/2},
\widehat{G}^{*}_{w;1-\alpha/2}   \right],\]</span></p>
<p>where <span class="math inline">\(\widehat{G}^{*}_{w;a}\)</span> is
the <span class="math inline">\(a\)</span>th quantile of the
bootstrapped coefficients <span class="math inline">\(\widehat{G}^{*}_{w}(b)\)</span>, with <span class="math inline">\(b=\{1,\ldots,B\}\)</span>, and which are obtained
by using the expression <span class="math inline">\(\widehat{G}_{w}\)</span> after substituting the
original survey weights <span class="math inline">\(w_{i}\)</span> by
the bootstrap weights <span class="math display">\[w_{i}^{*}(b)=w_{i}\frac{r_{i}n}{n-1},\]</span>
where <span class="math inline">\(r_{i}\)</span> is the number of times
that <span class="math inline">\(i\)</span>yh unit is selected by the
bootstrap procedure. A variance estimator of the Gini index based on the
rescaled bootstrap is defined as: <span class="math display">\[\widehat{V}_{B}(\widehat{G}_{w})= \displaystyle
\frac{1}{B-1}\sum_{b=1}^{B}\left(\widehat{G}^{*}_{w}(b) -
\overline{G}^{*}_{w} \right)^2,\]</span> where <span class="math display">\[\overline{G}^{*}_{w}=\frac{1}{B}\sum_{b=1}^{B}\widehat{G}^{*}_{w}(b).\]</span></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="co"># Gini index estimation and confidence interval using &#39;pbootstrap&#39;.</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="fu">fgini</span>(y, w, <span class="at">interval =</span> <span class="st">&quot;pbootstrap&quot;</span>)</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="co">#&gt; $Gini</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="co">#&gt; [1] 0.3205489</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="co">#&gt; $Interval</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="co">#&gt;          lower     upper</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="co">#&gt; [1,] 0.2935952 0.3453333</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a><span class="co">#&gt; $Variance</span></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="co">#&gt; [1] 0.0001664895</span></span></code></pre></div>
</div>
<div id="jackknife-1" class="section level3" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Jackknife</h3>
<p>The <code>&quot;zjackknife&quot;</code> method computes the variance of the
Gini index using the jackknife technique. For a given estimator <span class="math inline">\(\widehat{G}_{w}\)</span>, the pseudo-values for
variance estimation are defined as (see Berger, 2008): <span class="math display">\[z_{i}=\displaystyle
\frac{1}{w_{i}}\left(1-\frac{w_{i}}{\widehat{N}}\right)\left(\widehat{G}_{w}
- \widehat{G}_{w;-i}\right),\]</span><br />
where <span class="math inline">\(\widehat{G}_{w;-i}\)</span> denotes
the estimator <span class="math inline">\(\widehat{G}_{w}\)</span>
computed from <span class="math inline">\(S\setminus\{i\}\)</span>,
i.e., from the sample <span class="math inline">\(S\)</span> after
removing the <span class="math inline">\(i\)</span>th unit. For a
confidence level <span class="math inline">\(1-\alpha\)</span>, the
<code>&quot;zjackknife&quot;</code> confidence interval is defined as <span class="math display">\[\left[\widehat{G}_{w} -
Z_{1-\alpha/2}\sqrt{\widehat{V}(\widehat{G}_{w})},  \widehat{G}_{w} +
Z_{1-\alpha/2}\sqrt{\widehat{V}(\widehat{G}_{w})}   \right],\]</span>
where the variance <span class="math inline">\(\widehat{V}(\widehat{G}_{w})\)</span> is computed
using the pseudo-values <span class="math inline">\(z_i\)</span> and any
of the aforementioned type variance estimators (Horvitz-Thompson;
Sen-Yates-Grundy; or Harley-Rao).</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="co"># Gini index estimation and confidence interval using &#39;zjackknife&#39;.</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="fu">fgini</span>(y, w, <span class="at">interval =</span> <span class="st">&quot;zjackknife&quot;</span>)</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="co">#&gt; $Gini</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="co">#&gt; [1] 0.3205489</span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="co">#&gt; $Interval</span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="co">#&gt;          lower    upper</span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="co">#&gt; [1,] 0.2945728 0.346525</span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="co">#&gt; $Variance</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="co">#&gt; [1] 0.0001756514</span></span></code></pre></div>
</div>
<div id="linearization-1" class="section level3" number="2.2.3">
<h3><span class="header-section-number">2.2.3</span> Linearization</h3>
<p>The linearization technique for variance estimation (Deville, 1999)
has been applied to the following estimators of the Gini index: <span class="math display">\[\widehat{G}_{w}^{a}= \displaystyle
\frac{1}{2\widehat{N}^{2}\overline{y}_{w}}\sum_{i \in S}\sum_{j \in
S}w_{i}w_{j}|y_{i}-y_{j}|,\]</span></p>
<p>and <span class="math display">\[\widehat{G}_{w}^{b} = \displaystyle
\frac{2}{\widehat{N}\overline{y}_{w}}\sum_{i \in
S}w_{i}y_{i}\widehat{F}_{w}(y_{i})-1, \]</span></p>
<p>where <span class="math display">\[\widehat{F}_{w}(t)=\frac{1}{\widehat{N}}\sum_{i
\in S}w_i\delta(y_i \leq t)\]</span> For a given estimator <span class="math inline">\(\widehat{G}_w\)</span> and a linearizated variable
<span class="math inline">\(z\)</span>, the confidence interval, with
confidence level <span class="math inline">\(1-\alpha\)</span>, is
defined as<br />
<span class="math display">\[\left[\widehat{G}_w -
Z_{1-\alpha/2}\sqrt{\widehat{V}(\widehat{G}_w)},  \widehat{G}_w +
Z_{1-\alpha/2}\sqrt{\widehat{V}(\widehat{G}_w)}   \right],\]</span></p>
<p>where the variance <span class="math inline">\(\widehat{V}(\widehat{G}_w)\)</span> is computed
using the corresponding pseudo-values and any of the aforementioned type
variance estimators (Horvitz-Thompson; Sen-Yates-Grundy, or
Harley-Rao).</p>
<p>On the one hand, <code>interval = &quot;zalinearization&quot;</code>
linearizates the estimator <span class="math inline">\(\widehat{G}_{w}^{a}\)</span>, and the
corresponding pseudo-values are defined as (Langel anf Tillé 2013):</p>
<p><span class="math display">\[z_{(i)}^{a}=\frac{1}{\widehat{N}^{2}\overline{y}_w}\left[
2\widehat{N}_{(i)}\left( y_{(i)} - \widehat{\overline{Y}}_{(i)}\right) +
\widehat{N}\left\{ \overline{y}_{w} -  y_{(i)}
-  \widehat{G}_{w}^{a}\left(\overline{y}_{w} + y_{(i)} \right) \right\}
\right],\]</span> where <span class="math display">\[\widehat{\overline{Y}}_{(i)} = \displaystyle
\frac{1}{\widehat{N}_{(i)}}\sum_{j=1}^{i}w_{(j)}^{+}y_{(j)}.\]</span></p>
<p>On the other hand, <code>interval = &quot;zblinearization&quot;</code>
linearizates the estimator <span class="math inline">\(\widehat{G}_{w}^{b}\)</span>, and the
corresponding pseudo values are (see Berger, 2008):</p>
<p><span class="math display">\[z_i^{b}=\frac{1}{\hat{N}\overline{y}_{w}}\left[
2y_i\widehat{F}_{w}(y_i) -
(\widehat{G}_{w}^{b}+1)(y_i+\overline{y}_{w})+\frac{2}{\hat{N}}\sum_{j
\in S}w_jy_j\delta(y_j \geq y_i)  \right],\]</span> where <span class="math display">\[\widehat{F}_{w}(t) = \displaystyle
\frac{1}{\widehat{N}}\sum_{i \in S}w_{i}\delta(y_i \leq t).\]</span></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="co"># Gini index estimation and confidence interval using:</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a> <span class="do">## a: The method 2 for point estimation. </span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a> <span class="do">## b: The method &#39;zalinearization&#39; for variance estimation. </span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a> <span class="do">## c: The Sen-Yates-Grundy type variance estimator. </span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a> <span class="do">## d: The Hàjek approximation for the joint inclusion probabilities. </span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="fu">fgini</span>(y, w, <span class="at">interval =</span> <span class="st">&quot;zalinearization&quot;</span>)</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co">#&gt; $Gini</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="co">#&gt; [1] 0.3205489</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a><span class="co">#&gt; $Interval</span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co">#&gt;          lower    upper</span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="co">#&gt; [1,] 0.2946057 0.346492</span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="co">#&gt; $Variance</span></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a><span class="co">#&gt; [1] 0.0001752056</span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a><span class="co"># Gini index estimation and confidence interval using:</span></span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a> <span class="do">## a: The method 3 for point estimation. </span></span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a> <span class="do">## b: The method &#39;zblinearization&#39; for variance estimation. </span></span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a> <span class="do">## c: The Sen-Yates-Grundy type variance estimator. </span></span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a> <span class="do">## d: The Hàjek approximation for the joint inclusion probabilities. </span></span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a><span class="fu">fgini</span>(y, w, <span class="at">method =</span> <span class="dv">3</span>, <span class="at">interval =</span> <span class="st">&quot;zblinearization&quot;</span>)</span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a><span class="co">#&gt; $Gini</span></span>
<span id="cb18-25"><a href="#cb18-25" tabindex="-1"></a><span class="co">#&gt; [1] 0.3205489</span></span>
<span id="cb18-26"><a href="#cb18-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-27"><a href="#cb18-27" tabindex="-1"></a><span class="co">#&gt; $Interval</span></span>
<span id="cb18-28"><a href="#cb18-28" tabindex="-1"></a><span class="co">#&gt;          lower     upper</span></span>
<span id="cb18-29"><a href="#cb18-29" tabindex="-1"></a><span class="co">#&gt; [1,] 0.2944802 0.3466175</span></span>
<span id="cb18-30"><a href="#cb18-30" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-31"><a href="#cb18-31" tabindex="-1"></a><span class="co">#&gt; $Variance</span></span>
<span id="cb18-32"><a href="#cb18-32" tabindex="-1"></a><span class="co">#&gt; [1] 0.0001769051</span></span></code></pre></div>
</div>
</div>
</div>
<div id="references" class="section level1" number="3">
<h1><span class="header-section-number">3</span> References</h1>
<p>Alfons, A., and Templ, M. (2012). Estimation of social exclusion
indicators from complex surveys: The R package laeken. KU Leuven,
Faculty of Business and Economics Working Paper.</p>
<p>Berger, Y. G. (2005). Variance estimation with highly stratified
sampling designs with unequal probabilities. <em>Australian &amp; New
Zealand Journal of Statistics</em>, 47, 365–373.</p>
<p>Berger, Y. G. (2008). A note on the asymptotic equivalence of
jackknife and linearization variance estimation for the Gini
Coefficient. <em>Journal of Official Statistics</em>, 24(4),
541-555.</p>
<p>Berger, Y. G. (2011). Asymptotic consistency under large entropy
sampling designs with unequal probabilities. <em>Pakistan Journal of
Statistics</em>, 27, 407–426.</p>
<p>Berger, Y. G. and Tille, Y. (2009). Sampling with unequal
probabilities. In Sample Surveys: Design, Methods and Applications
(eds. D. Pfeffermann and C. R. Rao), 39–54. Elsevier, Amsterdam</p>
<p>Berger, Y., and Gedik Balay, İ. (2020). Confidence intervals of Gini
coefficient under unequal probability sampling. <em>Journal of Official
Statistics</em>, 36(2), 237-249.</p>
<p>David, H.A. (1968). Gini’s mean difference rediscovered.
<em>Biometrika</em>, 55, 573–575.</p>
<p>Davison, A. C., and Hinkley, D. V. (1997). <em>Bootstrap Methods and
Their Application</em> (Cambridge Series in Statistical and
Probabilistic Mathematics, No 1)–Cambridge University Press.</p>
<p>Deville, J.C. (1999). Variance Estimation for Complex Statistics and
Estimators: Linearization and Residual Techniques. <em>Survey
Methodology</em>, 25, 193–203.</p>
<p>Deltas, G. (2003). The small-sample bias of the Gini coefficient:
results and implications for empirical research. <em>Review of Economics
and Statistics</em>, 85(1), 226-234.</p>
<p>Giorgi, G. M., and Gigliarano, C. (2017). The Gini concentration
index: a review of the inference literature. <em>Journal of Economic
Surveys</em>, 31(4), 1130-1148.</p>
<p>Hàjek, J. (1964). Asymptotic theory of rejective sampling with
varying probabilities from a finite population. <em>The Annals of
Mathematical Statistics</em>, 35, 4, 1491–1523.</p>
<p>Hartley, H. O., and Rao, J. N. K. (1962). Sampling with unequal
probabilities and without replacement. <em>The Annals of Mathematical
Statistics</em>, 350-374.</p>
<p>Haziza, D., Mecatti, F. and Rao, J. N. K. (2008). Evaluation of some
approximate variance estimators under the Rao-Sampford unequal
probability sampling design. <em>Metron</em>, LXVI, 91–108.</p>
<p>Horvitz, D. G. and Thompson, D. J. (1952). A generalization of
sampling without replacement from a finite universe. <em>Journal of the
American Statistical Association</em>, 47, 663–685.</p>
<p>Kendall, M., and Stuart, A. (1977). <em>The advanced theory of
statistics. Vol. 1: Distribution Theory</em>. London: Griffin.</p>
<p>Langel, M., and Tillé, Y. (2013). Variance estimation of the Gini
index: revisiting a result several times published. <em>Journal of the
Royal Statistical Society: Series A (Statistics in Society)</em>,
176(2), 521-540.</p>
<p>Lerman, R. I., and Yitzhaki, S. (1989). Improving the accuracy of
estimates of Gini coefficients. <em>Journal of econometrics</em>, 42(1),
43-47.</p>
<p>Muñoz, J. F., Moya-Fernández, P. J., and Álvarez-Verdejo, E. (2023).
Exploring and Correcting the Bias in the Estimation of the Gini Measure
of Inequality. <em>Sociological Methods &amp; Research</em>. <a href="https://doi.org/10.1177/00491241231176847" class="uri">https://doi.org/10.1177/00491241231176847</a></p>
<p>Ogwang, T. (2000). A convenient method of computing the Gini index
and its standard error. <em>Oxford Bulletin of Economics and
Statistics</em>, 62(1), 123-123.</p>
<p>Owen, A. B. (2001). <em>Empirical likelihood</em>. CRC press.</p>
<p>Qin, Y., Rao, J. N. K., and Wu, C. (2010). Empirical likelihood
confidence intervals for the Gini measure of income inequality.
<em>Economic Modelling</em>, 27(6), 1429-1435.</p>
<p>Rao, J. N. K., Wu, C. F. J., and Yue, K. (1992). Some recent work on
resampling methods for complex surveys. <em>Survey methodology</em>,
18(2), 209-217.</p>
<p>Rust, K. F., and Rao, J. N. K. (1996). Variance estimation for
complex surveys using replication techniques. <em>Statistical methods in
medical research</em>, 5(3), 283-310.</p>
<p>Sen, A. R. (1953). On the estimate of the variance in sampling with
varying probabilities. <em>Journal of the Indian Society of Agricultural
Statistics</em>, 5, 119–127.</p>
<p>Tillé, Y. (2006). <em>Sampling Algorithms</em>. Springer, New
York.</p>
<p>Yates, F., and Grundy, P. M. (1953). Selection without replacement
from within strata with probability proportional to size. <em>Journal of
the Royal Statistical Society B</em>, 15, 253–261.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
